<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25" zv="Cache for Windows (x86-64) 2014.1.1 (Build 702U)" ts="2015-06-15 16:22:38">
<Class name="CLM.Broker">
<Super>%CSP.REST</Super>
<TimeChanged>63714,74013.212348</TimeChanged>
<TimeCreated>63714,58855.014604</TimeCreated>

<XData name="UrlMap">
<Data><![CDATA[
<Routes>
	<Route Url="/messages" Method="GET" Call="GetMessages"/>
	<Route Url="/messages" Method="PUT" Call="PutMessage"/>
</Routes>
]]></Data>
</XData>

<Method name="GetMessages">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set %response.ContentType = "application/json"
	
	set domain = %request.Data("domain", 1)
	set language = %request.Data("language", 1)
	write ##class(CLM.Utils).GetMessageList(domain, language)
	quit $$$OK
]]></Implementation>
</Method>

<Method name="PutMessage">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set domain = %request.Data("domain", 1)
	set language = %request.Data("langauge", 1)
	set id = %requesst.Data("id", 1)
	quit ##class(CLM.Utils).PutMessage(domain, language, id)
]]></Implementation>
</Method>
</Class>


<Project name="CLM" LastModified="2015-06-15 16:21:23.67807">
  <Items>
    <ProjectItem name="CLM.Broker" type="CLS"></ProjectItem>
    <ProjectItem name="CLM.Utils" type="CLS"></ProjectItem>
    <ProjectItem name="csp/clm/index.CSP" type="CSP"></ProjectItem>
  </Items>
</Project>


<Class name="CLM.Utils">
<TimeChanged>63714,80723.104569</TimeChanged>
<TimeCreated>63714,61614.83778</TimeCreated>

<Method name="ConvertToJSString">
<ClassMethod>1</ClassMethod>
<FormalSpec>string:%String</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[	return """" _ $zconvert(string, "O", "JS") _ """"
]]></Implementation>
</Method>

<Method name="OK">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	w "ok, pal"
	return $$$OK
]]></Implementation>
</Method>

<Method name="GetGlobalStructure">
<ClassMethod>1</ClassMethod>
<FormalSpec>global:%String="^CacheMsg"</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	set result = "{"
	
	set domain = ""
	while(1) {
		set domain = $order(@global@(domain))
		if (domain = "") {
			quit
		}
		set result = result _ ..ConvertToJSString(domain) _ ": ["
		set language = ""
		while (1)
		{
			set language = $order(@global@(domain, language))
			if (language = "") {
				quit
			}
			set result = result _ ..ConvertToJSString(language) _ ", "
		}
		set result = result _ "], "
	}
	
	return result _ "}"
]]></Implementation>
</Method>

<Method name="GetMessageList">
<ClassMethod>1</ClassMethod>
<FormalSpec>domain:%String,language:%String,global:%String="^CacheMsg"</FormalSpec>
<ReturnType>%String</ReturnType>
<Implementation><![CDATA[
	set result = "["
	set id = ""
	set delim = ""
	while (1) {
		set id = $order(@global@(domain, language, id))
		if (id = "") {
			quit
		}
		set result = result _ delim _
			"{""id"": "_
			..ConvertToJSString(id) _
			", ""text"": " _
			..ConvertToJSString(@global@(domain, language, id)) _
			"}"
		set delim = ","
	}
	set result = result _ "]"
	return result
]]></Implementation>
</Method>

<Method name="PutMessage">
<ClassMethod>1</ClassMethod>
<FormalSpec>domain:%String,language:%String,id:%String,global:%String="^CacheMsg"</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	w domain _ ", " _ language _ ", " _ id
	return $$$OK
]]></Implementation>
</Method>
</Class>


<CSP name="index.CSP" application="/csp/clm/"><![CDATA[
<!DOCTYPE html>
<html>
  <head>
    <title>Cach√© Localization Manager</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/grids-responsive-min.css">
    <link rel="stylesheet" href="custom.css">

    <script src="https://fb.me/react-0.13.3.js"></script>
    <script src="https://fb.me/JSXTransformer-0.13.3.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script type="text/javascript">
    var domains = #(##class(CLM.Utils).GetGlobalStructure())#;
    </script>
  </head>
  <body>
    <div id="content"></div>
    <script type="text/jsx" src="app.js"></script>
  </body>
</html>]]></CSP>
</Export>
