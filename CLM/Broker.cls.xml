<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="CLM.Broker">
<Super>%CSP.REST</Super>
<TimeCreated>63714,58855.014604</TimeCreated>

<XData name="UrlMap">
<Data><![CDATA[
<Routes>
	<Route Url="/messages" Method="GET" Call="GetMessages"/>
	<Route Url="/messages" Method="PUT" Call="PutMessage"/>
	<Route Url="/test" Method="GET" Call="Test"/>
	<Route Url="/add-new-localization" Method="POST" Call="AddNewLocalization"/>
</Routes>
]]></Data>
</XData>

<Method name="Test">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	w "test"
	q $$$OK
]]></Implementation>
</Method>

<Method name="GetMessages">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set %response.ContentType = "application/json"
	
	set domain = %request.Data("domain", 1)
	set language = %request.Data("language", 1)
	set spellcheck = %request.Data("spellcheck", 1)
	if (spellcheck = "true") {
		quit ##class(CLM.Utils).CheckMessages(domain, language, "^CacheMsg")
	} else {
		quit ##class(CLM.Utils).GetMessageList(domain, language, "^CacheMsg")
	}
]]></Implementation>
</Method>

<Method name="PutMessage">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set domain = %request.Data("domain", 1)
	set language = %request.Data("language", 1)
	set id = %request.Data("id", 1)
	set text = %request.Data("text", 1)
	quit ##class(CLM.Utils).PutMessage(domain, language, id, text, "^CacheMsg")
]]></Implementation>
</Method>

<Method name="AddNewLocalization">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set domain = %request.Data("domain", 1)
	set from = %request.Data("from", 1)
	set to = %request.Data("to", 1)
	
	quit ##class(CLM.Utils).AddNewLocalization($EXTRACT(from, 1, 2), to, domain)
]]></Implementation>
</Method>
</Class>
</Export>
